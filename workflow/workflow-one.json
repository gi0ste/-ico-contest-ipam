[{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","Description":"The Classless Inter-Domain Routing","Label":"CIDR Notation","Name":"CDIR","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"user","Tags":[{"Key":"owner","Value":"sgioia"}],"TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"CIDR Notation","Name":"CDIR","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints","Regex":"^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/(3[0-2]|[1-2][0-9]|[0-9]))$"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","Description":"An IPv4 address represented in dot decimal notation, such as '192.168.1.6'.","Label":"IPv4 Address","Name":"IpV4AddressType","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"An IPv4 address represented in dot decimal notation, such as '192.168.1.6'.","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"IPv4 Address","Name":"IpV4Address","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints","Regex":"^([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.([1-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Search for a network  in Infoblox and return the unique network object reference","Label":"Infoblox - Get network reference from subnet","Name":"Infoblox-Getnetworkreferencefromsubnet","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The API call can be made to Intersight or an external endpoint added as Target. Target should be in claimed or connected state. Please refer Supported Endpoints section in the Web API request end user documentation for the list of Intersight Targets on which Web API task can be invoked. An empty value for this input indicates that the API call is made to Intersight.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"External Target","Name":"Target","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=((TargetType eq HTTPEndpoint and Status eq Claimed) or ((TargetType eq PureStorageFlashArray or TargetType eq HitachiVirtualStoragePlatform or TargetType eq NetAppActiveIqUnifiedManager or TargetType eq TerraformCloud or TargetType eq VmwareVcenter or TargetType eq APIC or TargetType eq MDSDevice or TargetType eq NexusDevice) and Status eq Connected))","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"SupportedObjects":["asset.Target"]}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The network subnet (e.g. 192.168.1.0/24)","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Network Subnet","Name":"networkSubnet","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"user","CustomDataTypeName":"CDIR","ObjectType":"workflow.CustomDataProperty"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The view associated to the network","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Network View","Name":"networkView","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":" The network found","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Network","Name":"network","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The unique Reference Object for the given network. This reference is used to identify the network.","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Network Object Reference","Name":"networkObjectReference","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"RetryCount":3,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"user","Tags":[{"Key":"category","Value":"IPAM"},{"Key":"owner","Value":"sgioia"},{"Key":"integration","Value":"infoblox"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Get next available IPv4 address from a subnet using the next_available_ip function provided by Infoblox","Label":"Infoblox - Get next available IPv4 address","Name":"Infoblox-GetnextavailableIPv4address","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The subnet object reference where to get the IPv4","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Subnet Object Referece","Name":"subnetObjectReference","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The API call can be made to Intersight or an external endpoint added as Target. Target should be in claimed or connected state. Please refer Supported Endpoints section in the Web API request end user documentation for the list of Intersight Targets on which Web API task can be invoked. An empty value for this input indicates that the API call is made to Intersight.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"External Target","Name":"Target","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=((TargetType eq HTTPEndpoint and Status eq Claimed) or ((TargetType eq PureStorageFlashArray or TargetType eq HitachiVirtualStoragePlatform or TargetType eq NetAppActiveIqUnifiedManager or TargetType eq TerraformCloud or TargetType eq VmwareVcenter or TargetType eq APIC or TargetType eq MDSDevice or TargetType eq NexusDevice) and Status eq Connected))","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"SupportedObjects":["asset.Target"]}],"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The returned IPv4 Address","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"IPv4 Address","Name":"ipv4Address","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"IpV4AddressType","ObjectType":"workflow.CustomDataProperty"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"IP Address","Name":"ipAddress","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryCount":3,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"user","Tags":[{"Key":"category","Value":"IPAM"},{"Key":"owner","Value":"sgioia"},{"Key":"integration","Value":"infoblox"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Get the first IPv4 from Inflox in agiven network","InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The given network","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Subnet","Name":"subnet","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"user","CustomDataTypeName":"CDIR","ObjectType":"workflow.CustomDataProperty"},"Required":true},{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The claimed Infoblox target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Infoblox Target","Name":"infobloxTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq HTTPEndpoint and Status eq Claimed)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true}],"InputParameterSet":[],"Label":"ICOSample Get next available IP in a subnet","Name":"ICOSampleGetnextavailableIPinasubnet","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The returned IPv4 Address by Infoblox","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"IPv4 Address","Name":"ipv4AddressInfoblox","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"IpV4AddressType","ObjectType":"workflow.CustomDataProperty"}}],"OutputParameters":{"ipv4AddressInfoblox":"${InfobloxGetnextavailableIPv4address1.output.ipv4Address}"},"Properties":{"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"user","Tags":[{"Key":"integration","Value":"infoblox"}],"Tasks":[{"Name":"StartTask","NextTask":"InfobloxGetnetworkreferencefromsubnet1","ObjectType":"workflow.StartTask"},{"CatalogMoid":"user","Description":"Search for a network  in Infoblox and return the unique network object reference","InputParameters":{"Target":"${workflow.input.infobloxTarget}","networkSubnet":"${workflow.input.subnet}"},"Label":"Infoblox - Get network reference from subnet","Name":"InfobloxGetnetworkreferencefromsubnet1","ObjectType":"workflow.WorkerTask","OnSuccess":"InfobloxGetnextavailableIPv4address1","TaskDefinitionName":"Infoblox-Getnetworkreferencefromsubnet","Version":1},{"CatalogMoid":"user","Description":"Get next available IPv4 address from a subnet using the next_available_ip function provided by Infoblox","InputParameters":{"Target":"${workflow.input.infobloxTarget}","subnetObjectReference":"${InfobloxGetnetworkreferencefromsubnet1.output.networkObjectReference}"},"Label":"Infoblox - Get next available IPv4 address","Name":"InfobloxGetnextavailableIPv4address1","ObjectType":"workflow.WorkerTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"Infoblox-GetnextavailableIPv4address","Version":1},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"}],"UiInputFilters":[],"UiRenderingData":{"Positions":[{"Name":"StartTask","X":10,"Y":18},{"Name":"SuccessEndTask","X":10,"Y":971},{"Name":"FailureEndTask","X":152,"Y":971},{"Name":"InfobloxGetnetworkreferencefromsubnet1","X":64.5,"Y":96},{"Name":"InfobloxGetnextavailableIPv4address1","X":93.87860107421875,"Y":210.48004150390625}]},"VariableDefinition":[],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","Description":"Get the network object reference from a given subnet in CIDR format.","EndpointRequestType":"Internal","Label":"Get network object reference","Method":"GET","Name":"InvokeGenericWebApi1","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq (len .global.InvokeGenericWebApi1.output.fullResponse) 0}} ","Message":"The network is not in the system.","Name":"Network Not Found","Type":"TerminalError"},{"Condition":"{{gt .global.InvokeGenericWebApi1.output.HttpStatusCode 299}}","Message":"{{.global.InvokeGenericWebApi1.output.HttpStatusMsg}}","Name":"Error","Type":"TerminalError"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"networkReferenceObject","ObjectType":"content.Parameter","Path":"$[0]._ref","Secure":false,"Type":"string"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"networkView","ObjectType":"content.Parameter","Path":"$[0].network_view","Secure":false,"Type":"string"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"network","ObjectType":"content.Parameter","Path":"$[0].network","Secure":false,"Type":"string"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"fullResponse","ObjectType":"content.Parameter","Path":"$","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Endpoint","Url":"/wapi/v2.7/network?network={{.global.task.input.networkSubnet}}"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Search for a network  in Infoblox and return the unique network object reference","Name":"Infoblox - Get network reference from subnet","ObjectType":"workflow.BatchApiExecutor","Output":{"network":"{{.global.InvokeGenericWebApi1.output.network}}","networkObjectReference":"{{.global.InvokeGenericWebApi1.output.networkReferenceObject}}","networkReferenceObject":"{{.global.InvokeGenericWebApi1.output.networkReferenceObject}}","networkView":"{{.global.InvokeGenericWebApi1.output.networkView}}"},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"Infoblox-Getnetworkreferencefromsubnet\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"Body":"{\n\t\"num\":1\n}","ContentType":"json","Description":"Get next available address from a subnet","EndpointRequestType":"Internal","Label":"Get Next Available IPv4","Method":"POST","Name":"InvokeGenericWebApi1","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{gt .global.InvokeGenericWebApi1.output.HttpStatusCode 299}}\n","Message":"{{.global.InvokeGenericWebApi1.output.HttpStatusMsg}}: {{.global.InvokeGenericWebApi1.output.fullResponse}}","Name":"Error","Type":"TerminalError"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"availableIP","ObjectType":"content.Parameter","Path":"$.ips[0]","Secure":false,"Type":"string"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"fullResponse","ObjectType":"content.Parameter","Path":"$","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Endpoint","Url":"/wapi/v2.7/{{.global.task.input.subnetObjectReference}}?_function=next_available_ip"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Get next available IPv4 address from a subnet using the next_available_ip function provided by Infoblox","Name":"Infoblox - Get next available IPv4 address","ObjectType":"workflow.BatchApiExecutor","Output":{"ipAddress":"{{.global.InvokeGenericWebApi1.output.availableIP}}","ipv4Address":"{{.global.InvokeGenericWebApi1.output.availableIP}}"},"SharedScope":"user","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"Infoblox-GetnextavailableIPv4address\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"}]